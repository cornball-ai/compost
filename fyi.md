<!-- Generated by fyi::use_fyi_md() on 2026-02-06 -->
<!-- Regenerate with: fyi::use_fyi_md("compost") -->

# fyi: compost

## Exported Functions (compost::)

| Function | Arguments |
|----------|-----------|
| `chromakey` | background, foreground, output, color, similarity, blend, overwrite, dry_run |
| `concat` | inputs, output, overwrite, dry_run |
| `hstack` | left, right, output, width_left, width_right, height, overwrite, dry_run |
| `overlay` | background, foreground, output, x, y, scale, shortest, overwrite, dry_run |
| `probe` | file, field |
| `vstack` | top, bottom, output, height_top, height_bottom, width, overwrite, dry_run |


## Internal Functions (compost:::)

| Function | Arguments |
|----------|-----------|
| `.probe_field` | file, field, stream |
| `.run_ffmpeg` | args, dry_run |


## Options

No options found in `compost`.



# Documentation: compost

## chromakey

### Chromakey (Green/Blue Screen) Compositing

#### Description

Remove a colored background from foreground footage and composite
onto a background video or image using FFmpeg's chromakey filter.

#### Usage

```r
chromakey(
  background,
  foreground,
  output,
  color = "0x00ff00",
  similarity = 0.1,
  blend = 0.075,
  overwrite = TRUE,
  dry_run = FALSE
)
```

#### Arguments

- **`background`**: Path to background video or image.
- **`foreground`**: Path to foreground video with green/blue screen.
- **`output`**: Path for output video file.
- **`color`**: Hex color to key out (default "0x00ff00" for green).
- **`similarity`**: Chromakey similarity threshold (default 0.1).
Higher values key out more of the color.
- **`blend`**: Chromakey blend amount (default 0.075).
Higher values create softer edges.
- **`overwrite`**: If TRUE (default), overwrite output file.
- **`dry_run`**: If TRUE, return the FFmpeg command without executing.

#### Value

Invisibly returns the output path. If dry_run, returns command string.

#### Examples

```r
chromakey("bg.mp4", "greenscreen.mp4", "out.mp4")
chromakey("bg.mp4", "bluescreen.mp4", "out.mp4", color = "0x0000ff")
```


## concat

### Concatenate Video Segments

#### Description

Join multiple video files sequentially using FFmpeg's concat demuxer.
All inputs should have compatible codecs and dimensions.

#### Usage

```r
concat(inputs, output, overwrite = TRUE, dry_run = FALSE)
```

#### Arguments

- **`inputs`**: Character vector of paths to input video files.
- **`output`**: Path for output video file.
- **`overwrite`**: If TRUE (default), overwrite output file.
- **`dry_run`**: If TRUE, return the FFmpeg command without executing.

#### Value

Invisibly returns the output path. If dry_run, returns command string.

#### Examples

```r
concat(c("part1.mp4", "part2.mp4", "part3.mp4"), "full.mp4")
```


## dot-probe_field

### Query a Single Field via ffprobe

#### Description

Query a Single Field via ffprobe

#### Usage

```r
.probe_field(file, field, stream = "v:0")
```

#### Arguments

- **`file`**: Path to media file.
- **`field`**: The ffprobe field to query (e.g. "duration", "width", "height").
- **`stream`**: Stream specifier: "v:0" for video, "a:0" for audio.

#### Value

The field value as a character string.


## dot-run_ffmpeg

### Run FFmpeg Command

#### Description

Internal helper that executes ffmpeg with the given arguments.
Surfaces stderr on failure.

#### Usage

```r
.run_ffmpeg(args, dry_run = FALSE)
```

#### Arguments

- **`args`**: Character vector of ffmpeg arguments.
- **`dry_run`**: If TRUE, return the command string instead of running it.

#### Value

On success, the processx result (invisibly). On dry_run, the command string.


## hstack

### Horizontally Stack Two Videos

#### Description

Stack two videos side by side using FFmpeg's hstack filter.

#### Usage

```r
hstack(
  left,
  right,
  output,
  width_left = NULL,
  width_right = NULL,
  height = 1080,
  overwrite = TRUE,
  dry_run = FALSE
)
```

#### Arguments

- **`left`**: Path to left video.
- **`right`**: Path to right video.
- **`output`**: Path for output video file.
- **`width_left`**: Width in pixels for left video (default: auto from height).
- **`width_right`**: Width in pixels for right video (default: auto from height).
- **`height`**: Output height in pixels (default 1080).
- **`overwrite`**: If TRUE (default), overwrite output file.
- **`dry_run`**: If TRUE, return the FFmpeg command without executing.

#### Value

Invisibly returns the output path. If dry_run, returns command string.

#### Examples

```r
hstack("left.mp4", "right.mp4", "wide.mp4")
```


## overlay

### Overlay Foreground onto Background

#### Description

Composite a PNG (with alpha) or video over a background video or image
using FFmpeg's overlay filter.

#### Usage

```r
overlay(
  background,
  foreground,
  output,
  x = 0,
  y = 0,
  scale = NULL,
  shortest = TRUE,
  overwrite = TRUE,
  dry_run = FALSE
)
```

#### Arguments

- **`background`**: Path to background video or image.
- **`foreground`**: Path to foreground video or PNG (alpha supported).
- **`output`**: Path for output video file.
- **`x`**: Horizontal offset for overlay placement (default 0).
- **`y`**: Vertical offset for overlay placement (default 0).
- **`scale`**: Optional scale string for the foreground (e.g. "320:240" or "iw/2:ih/2").
- **`shortest`**: If TRUE (default), end output when the shortest input ends.
- **`overwrite`**: If TRUE (default), overwrite output file.
- **`dry_run`**: If TRUE, return the FFmpeg command without executing.

#### Value

Invisibly returns the output path. If dry_run, returns command string.

#### Examples

```r
overlay("bg.mp4", "character.png", "out.mp4", x = 312, y = 580)
overlay("bg.mp4", "logo.png", "out.mp4", x = 10, y = 10, scale = "100:100")
```


## probe

### Probe Video Metadata

#### Description

Query video file properties via ffprobe.

#### Usage

```r
probe(file, field = "duration")
```

#### Arguments

- **`file`**: Path to media file.
- **`field`**: Field to query. One of "duration", "width", "height", "codec_name",
"r_frame_rate", or any valid ffprobe stream entry. Use "all" to return
duration, width, height, and codec as a named list.

#### Value

For single fields, returns a numeric value (duration, width, height)
  or character string (codec_name, etc.). For field = "all", returns a named list.

#### Examples

```r
probe("video.mp4")                     # duration (default)
probe("video.mp4", "width")            # video width
probe("video.mp4", "all")              # list of duration, width, height, codec
```


## vstack

### Vertically Stack Two Videos

#### Description

Stack two videos vertically (top over bottom) using FFmpeg's vstack filter.
Useful for YouTube Shorts layout (e.g. SadTalker top + slideshow bottom).
Both inputs are scaled to the target width. Heights can be specified
individually; by default each gets half the frame.

#### Usage

```r
vstack(
  top,
  bottom,
  output,
  height_top = NULL,
  height_bottom = NULL,
  width = 1080,
  overwrite = TRUE,
  dry_run = FALSE
)
```

#### Arguments

- **`top`**: Path to top video.
- **`bottom`**: Path to bottom video.
- **`output`**: Path for output video file.
- **`height_top`**: Height in pixels for top video (default: auto from width).
- **`height_bottom`**: Height in pixels for bottom video (default: auto from width).
- **`width`**: Output width in pixels (default 1080).
- **`overwrite`**: If TRUE (default), overwrite output file.
- **`dry_run`**: If TRUE, return the FFmpeg command without executing.

#### Value

Invisibly returns the output path. If dry_run, returns command string.

#### Examples

```r
vstack("talking_head.mp4", "slideshow.mp4", "shorts.mp4")
vstack("top.mp4", "bottom.mp4", "out.mp4", height_top = 960, height_bottom = 960)
```


